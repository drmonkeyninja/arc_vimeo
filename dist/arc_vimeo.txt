# arc_vimeo v1.1.4
# Embed Vimeo videos with customised player
# Andy Carter
# https://andy-carter.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjQ6Im5hbWUiO3M6OToiYXJjX3ZpbWVvIjtzOjc6InZlcnNpb24iO3M6NToiMS4x
LjQiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9yX3VyaSI7
czoyNDoiaHR0cHM6Ly9hbmR5LWNhcnRlci5jb20vIjtzOjExOiJkZXNjcmlwdGlvbiI7czo0
MToiRW1iZWQgVmltZW8gdmlkZW9zIHdpdGggY3VzdG9taXNlZCBwbGF5ZXIiO3M6NDoidHlw
ZSI7aTowO3M6NDoiaGVscCI7czozNjEzOiIJPGgxPmFyY192aW1lbzwvaDE+CgoJPHA+RWFz
aWx5IGVtYmVkIFZpbWVvIHZpZGVvcyBpbiBhcnRpY2xlcyBhbmQgY3VzdG9taXNlIHRoZSBh
cHBlYXJhbmNlIG9mIHRoZSBwbGF5ZXIuPC9wPgoKCTxoMiBpZD0iaGVscC1zZWN0aW9uMDMi
PlRhZ3M8L2gyPgoKCTxoMz5hcmNfdmltZW88L2gzPgoKCTxwPkVtYmVkcyBhIFZpbWVvIHZp
ZGVvIGluIHRoZSBwYWdlIHVzaW5nIGFuIGlmcmFtZS48L3A+Cgo8cHJlPjxjb2RlPiZsdDt0
eHA6YXJjX3ZpbWVvIC8mZ3Q7CjwvY29kZT48L3ByZT4KCgk8aDQ+VmlkZW8gYXR0cmlidXRl
czwvaDQ+CgoJPHVsPgoJCTxsaT48ZW0+dmlkZW88L2VtPiAmIzgyMTE7IFZpbWVvIHVybCBv
ciB2aWRlbyBJRCBmb3IgdGhlIHZpZGVvIHlvdSB3YW50IHRvIGVtYmVkPC9saT4KCQk8bGk+
PGVtPmN1c3RvbTwvZW0+ICYjODIxMTsgTmFtZSBvZiB0aGUgY3VzdG9tIGZpZWxkIGNvbnRh
aW5pbmcgdmlkZW8gSURzL3VybHMgYXNzb2NpYXRlZCB3aXRoIGFydGljbGU8L2xpPgoJPC91
bD4KCgk8aDQ+QmFzaWMgYXR0cmlidXRlczwvaDQ+CgoJPHVsPgoJCTxsaT48ZW0+bGFiZWw8
L2VtPiAmIzgyMTE7IExhYmVsIGZvciB0aGUgdmlkZW88L2xpPgoJCTxsaT48ZW0+bGFiZWx0
YWc8L2VtPiAmIzgyMTE7IEluZGVwZW5kZW50IHdyYXB0YWcgZm9yIGxhYmVsPC9saT4KCQk8
bGk+PGVtPndyYXB0YWc8L2VtPiAmIzgyMTE7IDxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9z
cGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0czwv
bGk+CgkJPGxpPjxlbT5jbGFzczwvZW0+ICYjODIxMTsgPHNwYW4gY2xhc3M9ImNhcHMiPkNT
Uzwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC9saT4KCTwvdWw+CgoJPGgz
PkN1c3RvbWlzaW5nIHRoZSBWaW1lbyBwbGF5ZXI8L2gzPgoKCTxwPllvdSBjYW4gY3VzdG9t
aXNlIHRoZSBhcHBlYXJhbmNlIG9mIHRoZSBWaW1lbyBwbGF5ZXIgdXNpbmcgdGhpcyBwbHVn
aW4gdG8gZGVmaW5lIHRoaW5ncyBsaWtlIGNvbG91cnMgYW5kIHNpemUuPC9wPgoKCTx1bD4K
CQk8bGk+PGVtPndpZHRoPC9lbT4gJiM4MjExOyBXaWR0aCBvZiB2aWRlbzwvbGk+CgkJPGxp
PjxlbT5oZWlnaHQ8L2VtPiAmIzgyMTE7IEhlaWdodCBvZiB2aWRlbzwvbGk+CgkJPGxpPjxl
bT5yYXRpbzwvZW0+ICYjODIxMTsgQXNwZWN0IHJhdGlvIChkZWZhdWx0cyA0OjMpPC9saT4K
CQk8bGk+PGVtPmNvbG9yPC9lbT4gJiM4MjExOyBBIGhleCBjb2xvdXIgY29kZSBmb3IgdGhl
IHBsYXllciBVSSBlbGVtZW50czwvbGk+CgkJPGxpPjxlbT5wb3J0cmFpdDwvZW0+ICYjODIx
MTsgJiM4MjE2OzAmIzgyMTc7IHRvIGRpc2FibGUgdGhlIHVzZXImIzgyMTc7cyBwb3J0cmFp
dDwvbGk+CgkJPGxpPjxlbT50aXRsZTwvZW0+ICYjODIxMTsgJiM4MjE2OzAmIzgyMTc7IHRv
IGRpc2FibGUgdGhlIHZpZGVvJiM4MjE3O3MgdGl0bGU8L2xpPgoJCTxsaT48ZW0+YnlsaW5l
PC9lbT4gJiM4MjExOyAmIzgyMTY7MCYjODIxNzsgdG8gZGlzYWJsZSB0aGUgdmlkZW8mIzgy
MTc7cyBieWxpbmU8L2xpPgoJCTxsaT48ZW0+YmFkZ2U8L2VtPiAmIzgyMTE7ICYjODIxNjsw
JiM4MjE3OyB0byBkaXNhYmxlIHRoZSB2aWRlbyYjODIxNztzIGJhZGdlPC9saT4KCQk8bGk+
PGVtPmxvb3A8L2VtPiAmIzgyMTE7ICYjODIxNjsxJiM4MjE3OyB0byBsb29wIHRoZSB2aWRl
byBvbiBwbGF5PC9saT4KCQk8bGk+PGVtPmF1dG9wbGF5PC9lbT4gJiM4MjExOyAmIzgyMTY7
MSYjODIxNzsgdG8gYXV0b3BsYXkgdGhlIHZpZGVvLCAmIzgyMTY7MCYjODIxNzsgdG8gdHVy
biBvZmYgYXV0b3BsYXkgKGRlZmF1bHQpPC9saT4KCQk8bGk+PGVtPmF1dG9wYXVzZTwvZW0+
ICYjODIxMTsgJiM4MjE2OzEmIzgyMTc7IHRvIGF1dG9wYXVzZSB0aGUgdmlkZW8gd2hlbiBh
bm90aGVyIGlzIHBsYXllZCBvbiB0aGUgc2FtZSBwYWdlPC9saT4KCTwvdWw+CgoJPGgyPmFy
Y19pZl92aW1lbzwvaDI+CgoJPHA+SW4gYWRkaXRpb24gdG8gYXJjX3ZpbWVvIHRoaXMgcGx1
Z2luIGFsc28gY29tZXMgd2l0aCBhcmNfaWZfdmltZW8sIGEgY29uZGl0aW9uYWwgdGFnIGZv
ciBjaGVja2luZyBpZiB0aGUgdmlkZW8gPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4g
aXMgYSBWaW1lbyBvbmUuPC9wPgoKPHByZT48Y29kZT4mbHQ7dHhwOmFyY19pZl92aW1lbyB2
aWRlbz0mcXVvdDtbVVJMXSZxdW90OyZndDsmbHQ7L3R4cDphcmNfaWZfdmltZW8mZ3Q7Cjwv
Y29kZT48L3ByZT4KCgk8aDQ+QXR0cmlidXRlczwvaDQ+CgoJPHA+VXNlIG9uZSBvciB0aGUg
b3RoZXIgb2YgdGhlIGZvbGxvd2luZzotPC9wPgoKCTx1bD4KCQk8bGk+PGVtPmN1c3RvbTwv
ZW0+ICYjODIxMTsgTmFtZSBvZiB0aGUgY3VzdG9tIGZpZWxkIGNvbnRhaW5pbmcgdmlkZW8g
SURzL3VybHMgYXNzb2NpYXRlZCB3aXRoIGFydGljbGU8L2xpPgoJCTxsaT48ZW0+dmlkZW88
L2VtPiAmIzgyMTE7IEEgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gdG8gY2hlY2sg
aWYgaXQgaXMgYSB2YWxpZCBWaW1lbyA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwv
bGk+Cgk8L3VsPgoKCTxoMiBpZD0iaGVscC1zZWN0aW9uMDQiPkV4YW1wbGVzPC9oMj4KCgk8
aDM+RXhhbXBsZSAxOiBVc2UgY3VzdG9tIGZpZWxkIHRvIGFzc29jaWF0ZSB2aWRlbyB3aXRo
IGFuIGFydGljbGU8L2gzPgoKPHByZT48Y29kZT4mbHQ7dHhwOmFyY192aW1lbyBjdXN0b209
JnF1b3Q7VmltZW8mcXVvdDsgLyZndDsKPC9jb2RlPjwvcHJlPgoKCTxoMz5FeGFtcGxlIDI6
IFNldCB0aGUgc2l6ZSBvZiB0aGUgcGxheWVyPC9oMz4KCjxwcmU+PGNvZGU+Jmx0O3R4cDph
cmNfdmltZW8gdmlkZW89JnF1b3Q7aHR0cHM6Ly92aW1lby5jb20vODYyOTU0NTImcXVvdDsg
d2lkdGg9JnF1b3Q7NTAwJnF1b3Q7IHJhdGlvPSZxdW90OzE2OjkmcXVvdDsgLyZndDsKPC9j
b2RlPjwvcHJlPgoKCTxoMz5FeGFtcGxlIDM6IFVzaW5nIHRoZSBjb25kaXRpb25hbCB0YWc8
L2gzPgoKPHByZT48Y29kZT4mbHQ7dHhwOmFyY19pZl92aW1lbyB2aWRlbz0mcXVvdDtodHRw
czovL3ZpbWVvLmNvbS84NjI5NTQ1MiZxdW90OyZndDsKICAgIFllcwombHQ7dHhwOmVsc2Ug
LyZndDsKICAgIE5vCiZsdDsvdHhwOmFyY19pZl92aW1lbyZndDsKPC9jb2RlPjwvcHJlPgoK
CTxoMiBpZD0iaGVscC1zZWN0aW9uMDUiPkF1dGhvcjwvaDI+CgoJPHA+PGEgaHJlZj0iaHR0
cHM6Ly9hbmR5LWNhcnRlci5jb20iPkFuZHkgQ2FydGVyPC9hPi48L3A+CgoJPHA+Q29udHJp
YnV0b3JzOiBBbmR5IENhcnRlciBhbmQgS2V2aW4gQXNod29ydGguPC9wPgoKCTxwPlRoYW5r
cyB0byA8YSBocmVmPSJodHRwOi8va2V2aW5hc2h3b3J0aC5jb20vIj5LZXZpbiBBc2h3b3J0
aDwvYT4gZm9yIHBvaW50aW5nIG91dCBzZXZlcmFsIGJ1Z3Mgd2l0aCB0aGUgcGx1Z2luLjwv
cD4KCgk8aDIgaWQ9ImhlbHAtc2VjdGlvbjA2Ij5MaWNlbnNlPC9oMj4KCgk8cD48YSBocmVm
PSJodHRwczovL2dpdGh1Yi5jb20vZHJtb25rZXluaW5qYS9hcmNfdmltZW8vYmxvYi9tYXN0
ZXIvTElDRU5TRSIgdGl0bGU9Ik1JVCI+VGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5NSVQ8L3Nw
YW4+IExpY2Vuc2U8L2E+PC9wPgoKIjtzOjQ6ImNvZGUiO3M6MzkxOToiCmlmIChjbGFzc19l
eGlzdHMoJ1xUZXh0cGF0dGVyblxUYWdcUmVnaXN0cnknKSkgewogICAgLy8gUmVnaXN0ZXIg
VGV4dHBhdHRlcm4gdGFncyBmb3IgVFhQIDQuNisuCiAgICBUeHA6OmdldCgnXFRleHRwYXR0
ZXJuXFRhZ1xSZWdpc3RyeScpCiAgICAgICAgLT5yZWdpc3RlcignYXJjX3ZpbWVvJykKICAg
ICAgICAtPnJlZ2lzdGVyKCdhcmNfaWZfdmltZW8nKTsKfQoKZnVuY3Rpb24gYXJjX3ZpbWVv
KCRhdHRzLCAkdGhpbmcpCnsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgJGRlZmF1
bHRzID0gYXJyYXkoCiAgICAgICAgJ3ZpZGVvJyAgICAgPT4gJycsCiAgICAgICAgJ2N1c3Rv
bScgICAgPT4gJ1ZpbWVvIElEJywKICAgICAgICAnd2lkdGgnICAgICA9PiAnMCcsCiAgICAg
ICAgJ2hlaWdodCcgICAgPT4gJzAnLAogICAgICAgICdyYXRpbycgICAgID0+ICc0OjMnLAog
ICAgICAgICdjb2xvcicgICAgID0+IG51bGwsCiAgICAgICAgJ3BvcnRyYWl0JyAgPT4gbnVs
bCwKICAgICAgICAndGl0bGUnICAgICA9PiBudWxsLAogICAgICAgICdieWxpbmUnICAgID0+
IG51bGwsCiAgICAgICAgJ2JhZGdlJyAgICAgPT4gbnVsbCwKICAgICAgICAnbG9vcCcgICAg
ICA9PiBudWxsLAogICAgICAgICdhdXRvcGF1c2UnID0+IG51bGwsCiAgICAgICAgJ2F1dG9w
bGF5JyAgPT4gbnVsbCwKICAgICAgICAnbGFiZWwnICAgICA9PiAnJywKICAgICAgICAnbGFi
ZWx0YWcnICA9PiAnJywKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywKICAgICAgICAnY2xh
c3MnICAgICA9PiBfX0ZVTkNUSU9OX18KICAgICk7CgogICAgZXh0cmFjdChsQXR0cygkZGVm
YXVsdHMsICRhdHRzKSk7CgogICAgJGN1c3RvbSA9IHN0cnRvbG93ZXIoJGN1c3RvbSk7CiAg
ICBpZiAoISR2aWRlbyAmJiBpc3NldCgkdGhpc2FydGljbGVbJGN1c3RvbV0pKSB7CiAgICAg
ICAgJHZpZGVvID0gJHRoaXNhcnRpY2xlWyRjdXN0b21dOwogICAgfQoKICAgICRtYXRjaCA9
IF9hcmNfdmltZW8oJHZpZGVvKTsKICAgIGlmICgkbWF0Y2gpIHsKICAgICAgICAkdmlkZW8g
PSAkbWF0Y2g7CiAgICB9IGVsc2VpZiAoZW1wdHkoJHZpZGVvKSkgewogICAgICAgIHJldHVy
biAnJzsKICAgIH0KCiAgICAvLyBJZiB0aGUgd2lkdGggYW5kL29yIGhlaWdodCBoYXMgbm90
IGJlZW4gc2V0IHdlIHdhbnQgdG8gY2FsY3VsYXRlIG5ldwogICAgLy8gb25lcyB1c2luZyB0
aGUgYXNwZWN0IHJhdGlvLgogICAgaWYgKCEkd2lkdGggfHwgISRoZWlnaHQpIHsKICAgICAg
ICAvLyBXb3JrIG91dCB0aGUgYXNwZWN0IHJhdGlvLgogICAgICAgIHByZWdfbWF0Y2goIi8o
XGQrKTooXGQrKS8iLCAkcmF0aW8sICRtYXRjaGVzKTsKICAgICAgICBpZiAoJG1hdGNoZXNb
MF0gJiYgJG1hdGNoZXNbMV0hPTAgJiYgJG1hdGNoZXNbMl0hPTApIHsKICAgICAgICAgICAg
JGFzcGVjdCA9ICRtYXRjaGVzWzFdLyRtYXRjaGVzWzJdOwogICAgICAgIH0gZWxzZSB7CiAg
ICAgICAgICAgICRhc3BlY3QgPSAxLjMzMzsKICAgICAgICB9CgogICAgICAgIC8vIENhbGN1
YXRlIHRoZSBuZXcgd2lkdGgvaGVpZ2h0LgogICAgICAgIGlmICgkd2lkdGgpIHsKICAgICAg
ICAgICAgJGhlaWdodCA9ICR3aWR0aC8kYXNwZWN0OwogICAgICAgIH0gZWxzZWlmICgkaGVp
Z2h0KSB7CiAgICAgICAgICAgICR3aWR0aCA9ICRoZWlnaHQqJGFzcGVjdDsKICAgICAgICB9
IGVsc2UgewogICAgICAgICAgICAkd2lkdGggPSA0MjU7CiAgICAgICAgICAgICRoZWlnaHQg
PSAzNDQ7CiAgICAgICAgfQoKICAgIH0KCiAgICAkc3JjID0gJy8vcGxheWVyLnZpbWVvLmNv
bS92aWRlby8nIC4gJHZpZGVvOwoKICAgICRxU3RyaW5nID0gYXJyYXkoKTsKCiAgICAvLyBD
aGVjayBpZiB0aGUgcGxheWVyJ3MgVUkgY29sb3VyIGlzIGJlaW5nIGN1c3RvbWlzZWQuCiAg
ICBpZiAoJGNvbG9yICYmIHByZWdfbWF0Y2goJ3xeIz8oW2EtejAtOV17Nn0pJHxpJywgJGNv
bG9yLCAkbWF0Y2gpKSB7CiAgICAgICAgJHFTdHJpbmdbXSA9ICdjb2xvcj0nIC4gJG1hdGNo
WzFdOwogICAgfQoKICAgIC8vIENoZWNrIHdoZXRoZXIgdG8gc2hvdyBvciBoaWRlIHRoZSB1
c2VyJ3MgcG9ydHJhaXQgZnJvbSB0aGUgdmlkZW8uCiAgICBpZiAoJHBvcnRyYWl0IT09bnVs
bCkgewogICAgICAgICRxU3RyaW5nW10gPSAncG9ydHJhaXQ9JyAuICgkcG9ydHJhaXQgPyAn
MScgOiAnMCcpOwogICAgfQoKICAgIC8vIENoZWNrIHdoZXRoZXIgdG8gc2hvdyBvciBoaWRl
IHRoZSB2aWRlbyB0aXRsZS4KICAgIGlmICgkdGl0bGUhPT1udWxsKSB7CiAgICAgICAgJHFT
dHJpbmdbXSA9ICd0aXRsZT0nIC4gKCR0aXRsZSA/ICcxJyA6ICcwJyk7CiAgICB9CgogICAg
Ly8gQ2hlY2sgd2hldGhlciB0byBzaG93IG9yIGhpZGUgdGhlIHVzZXIncyBieWxpbmUuCiAg
ICBpZiAoJGJ5bGluZSE9PW51bGwpIHsKICAgICAgICAkcVN0cmluZ1tdID0gJ2J5bGluZT0n
IC4gKCRieWxpbmUgPyAnMScgOiAnMCcpOwogICAgfQoKICAgIC8vIENoZWNrIHdoZXRoZXIg
dG8gc2hvdyBvciBoaWRlIHRoZSBiYWRnZS4KICAgIGlmICgkYmFkZ2UhPT1udWxsKSB7CiAg
ICAgICAgJHFTdHJpbmdbXSA9ICdiYWRnZT0nIC4gKCRiYWRnZSA/ICcxJyA6ICcwJyk7CiAg
ICB9CgogICAgLy8gQ2hlY2sgd2hldGhlciB0byBwbGF5IHRoZSB2aWRlbyBvbiBsb29wLgog
ICAgaWYgKCRsb29wIT09bnVsbCkgewogICAgICAgICRxU3RyaW5nW10gPSAnbG9vcD0nIC4g
KCRsb29wID8gJzEnIDogJzAnKTsKICAgIH0KCiAgICAvLyBDaGVjayB3aGV0aGVyIHRvIGVu
YWJsZS9kaXNhYmxlIGF1dG9wYXVzZS4KICAgIGlmICgkYXV0b3BhdXNlIT09bnVsbCkgewog
ICAgICAgICRxU3RyaW5nW10gPSAnYXV0b3BhdXNlPScgLiAoJGF1dG9wYXVzZSA/ICcxJyA6
ICcwJyk7CiAgICB9CgogICAgLy8gQ2hlY2sgd2hldGhlciB0byBlbmFibGUvZGlzYWJsZSBh
dXRvcGxheS4KICAgIGlmICgkYXV0b3BsYXkhPT1udWxsKSB7CiAgICAgICAgJHFTdHJpbmdb
XSA9ICdhdXRvcGxheT0nIC4gKCRhdXRvcGxheSA/ICcxJyA6ICcwJyk7CiAgICB9CgogICAg
Ly8gQ2hlY2sgaWYgd2UgbmVlZCB0byBhcHBlbmQgYSBxdWVyeSBzdHJpbmcgdG8gdGhlIHZp
ZGVvIHNyYy4KICAgIGlmICghZW1wdHkoJHFTdHJpbmcpKSB7CiAgICAgICAgJHNyYyAuPSAn
PycgLiBpbXBsb2RlKCcmYW1wOycsICRxU3RyaW5nKTsKICAgIH0KCiAgICAkb3V0ID0gIjxp
ZnJhbWUgc3JjPVwiJHNyY1wiIHdpZHRoPVwiJHdpZHRoXCIgaGVpZ2h0PVwiJGhlaWdodFwi
IGZyYW1lYm9yZGVyPVwiMFwiIHdlYmtpdGFsbG93ZnVsbHNjcmVlbiBtb3phbGxvd2Z1bGxz
Y3JlZW4gYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPiI7CgogICAgcmV0dXJuIGRvTGFiZWwo
JGxhYmVsLCAkbGFiZWx0YWcpIC4gKCgkd3JhcHRhZykgPyBkb1RhZygkb3V0LCAkd3JhcHRh
ZywgJGNsYXNzKSA6ICRvdXQpOwoKfQoKZnVuY3Rpb24gYXJjX2lmX3ZpbWVvKCRhdHRzLCAk
dGhpbmcpCnsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhh
cnJheSgKICAgICAgICAnY3VzdG9tJyA9PiBudWxsLAogICAgICAgICd2aWRlbycgPT4gbnVs
bAogICAgKSwgJGF0dHMpKTsKCiAgICAkcmVzdWx0ID0gJHZpZGVvID8gX2FyY192aW1lbygk
dmlkZW8pIDogX2FyY192aW1lbygkdGhpc2FydGljbGVbc3RydG9sb3dlcigkY3VzdG9tKV0p
OwoKICAgIHJldHVybiBwYXJzZShFdmFsRWxzZSgkdGhpbmcsICRyZXN1bHQpKTsKfQoKZnVu
Y3Rpb24gX2FyY192aW1lbygkdmlkZW8pCnsKICAgIGlmIChwcmVnX21hdGNoKCcjXmh0dHBz
PzovLygocGxheWVyfHd3dylcLik/dmltZW9cLmNvbSgvdmlkZW8pPy8oXGQrKSNpJywgJHZp
ZGVvLCAkbWF0Y2hlcykpIHsKICAgICAgICByZXR1cm4gJG1hdGNoZXNbNF07CiAgICB9Cgog
ICAgcmV0dXJuIGZhbHNlOwp9CiI7czozOiJtZDUiO3M6MzI6ImY3Y2I0YTIyNjQyZDRkMjFl
MzQ1YjBmODJkZTRjMTgyIjt9
